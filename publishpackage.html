<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="icon" href="img/favicon.png" type="image/png">
        <title>Mesut</title>
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="vendors/linericon/style.css">
        <link rel="stylesheet" href="css/font-awesome.min.css">
        <link rel="stylesheet" href="vendors/owl-carousel/owl.carousel.min.css">
        <link rel="stylesheet" href="vendors/lightbox/simpleLightbox.css">
        <link rel="stylesheet" href="vendors/nice-select/css/nice-select.css">
        <link rel="stylesheet" href="vendors/animate-css/animate.css">
        <link rel="stylesheet" href="vendors/popup/magnific-popup.css">
        <link rel="stylesheet" href="vendors/flaticon/flaticon.css">
        <!-- main css -->
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/responsive.css">
    <!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158119194-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-158119194-2');</script></head>
    <body>
        
        <!--================Header Menu Area =================-->
        <header class="header_area">
            <div class="main_menu">
            	<nav class="navbar navbar-expand-lg navbar-light">
					<div class="container box_1620">
						<!-- Brand and toggle get grouped for better mobile display -->
						<a class="navbar-brand logo_h" href="index.html"><img src="img/logo.png" alt=""></a>
						<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<!-- Collect the nav links, forms, and other content for toggling -->
						<div class="collapse navbar-collapse offset" id="navbarSupportedContent">
							<ul class="nav navbar-nav menu_nav ml-auto">
								<li class="nav-item active"><a class="nav-link" href="index.html">Home</a></li><li class="nav-item active"><a class="nav-link" href="moreaboutme.html">More About Me</a></li>  															
								<li class="nav-item active"><a class="nav-link" href="technical.html">Technical Context</a></li> 
								<li class="nav-item active"><a class="nav-link" href="conferences.html">Public Speaking</a></li> 	
								<li class="nav-item active"><a class="nav-link" href="travel.html">Travel</a></li> 										
							</ul>
						</div> 
					</div>
            	</nav>
            </div>
        </header>
        <!--================Header Menu Area =================-->
        
        <!--================Home Banner Area =================-->
        <section class="home_banner_area">
           	<div class="container box_1620">
           		<div class="banner_inner d-flex align-items-center">
					<div class="banner_content">
						<div class="media">							
							<div class="media-body">
								<div class="personal_text">									
									Sometimes we want to share our test solution to the community, which is basically Testing as a Service. In this blog, let's see how a package can be published step by step. Packages or plugins can be implemented for both Cypress and Playwright, but in this case I will illustrate a Cypress example.									
									
									What we will go through is:<br><br>
									<ul>
										<li>Npm account</li>
										<li>Initializing the project</li>									  
										<li>Implementing in TS</li>
										<li>Compiling TS</li>
										<li>Publish</li>
										<li>Usage in Other Projects</li>
									</ul>
									<h2>Npm account</h2>													
									npm is the node package manager. (<a href="javascript.html">see</a>) Packages can be queries via <a href="https://www.npmjs.com/">repo</a> or <a href="https://registry.npmjs.org/">api</a>.<br><br>
									
									Since npm repo may sometimes take too long, and you may not wanna just pay the 7 dollars/month to host your packages in the official npm private registry; you can configure npm settings to use a private repo which basically mirrors the global npm repo. In this way, you use a proxy in your own network. This is done by Nexus settings.<br><br>
									
									If the PC configuration is directed towards Nexus, but you wanna use npm, you have to create a .npmrc file including the line: 
									<code>registry=https://registry.npmjs.org/</code><br><br>The other way is adding the config into package.json file:
								</div>
							</div>							
						</div>	<br>								
						<div class="media">
							<div class="d-flex">
								<img src="img/technical/publishconfig.png" alt="">
							</div>						
						</div><br>
						<div class="media">							
							<div class="media-body">
								<div class="personal_text">									
									After the settings are done and having an account on npm, the command <code>npm login</code> is executed. This will forward you to the browser to login. After login is completed, you can verify your session via <code>npm whoami</code>.	<br><br>
									<h2>Initialize the Project</h2>													
									<code>npm init</code> command starts creating a package.json file by asking to fill in several attributes. You can pass -y flag to set all fields to default values. Eventually when the package is publisg these attributes will be seen on the npm repo like author, version and dependency values. A sample package.json file would look like: <br><br>
									
								
								</div>
							</div>							
						</div>
						<div class="media">
							<div class="d-flex">
								<img src="img/technical/packagejson.png" alt="">
							</div>						
						</div><br>
						<div class="media">							
							<div class="media-body">
								<div class="personal_text">									
									
									<h2>Implementation with Typescript</h2>													
									First get typescript since we want to use it as the programming language: <code>npm install --save-dev typescript</code>. We will use it only for development purposes, so we can add it as a dev-dependency (-D flag does the same). We will see dependency types below. After we add the dependency, it should be in the package.json:
								</div>
							</div>							
						</div><br>
						<div class="media">
							<div class="d-flex">
								<img src="img/technical/tsdep.png" alt="">
							</div>						
						</div><br>
						<div class="media">							
							<div class="media-body">
								<div class="personal_text">															
									Suppose we have a test case, where implemented several steps. We can move some of those steps into another class as function. (One paranthesis about the implementation: Quick note regarding the types vs interfaces. Both can be used to declare typed objects. But refer this <a href="https://stackoverflow.com/questions/37233735/interfaces-vs-types-in-typescript/52682220#52682220">link</a> for more details.) Let's create a new file under a seperate folder (src/my_functions.ts) and export functions. Later, they can be imported into any project and used to perform those steps. On the image below, there is a test implemented from scratch on the left, where some steps are moved to exported functions in a new file on the right. [Please dont mind the quality of the implementation, that is not our concern as of now. There are locators inside the test, locators are not selected properly, code is not efficient. But we might have another blog to discuss about the code quality.]
								</div>
							</div>							
						</div><br>
						<div class="media">
							<div class="d-flex">
								<img src="img/technical/cytest.png" alt="">
							</div>						
						</div><br>
						<div class="media">							
							<div class="media-body">
								<div class="personal_text">	
									We can add a special function which will be later used for registering function calls as Cypress custom commands. <br><br><code>
									
									export const registerCommand = () => {
										Cypress.Commands.add("goToPage", (url) => {
											goToPage(url)
										})...

									}
									</code><br><br>
									When we are done, let's create an index file in the same directory: src/index.ts. In the index file all funtions are declared: <code>export * from './my_functions'</code>. Notice that extension is not needed to address the file here. One more reminder is, these files are generally collected under a reasonably named folder such as src, dist or lib.<br><br>
									<h2>Compiling TS</h2>													
									As we discussed in another <a href="javascript.html">blog</a>, TS code needs to be compiled. We will use tsc command for this, but first let's initialize: <code>npx tsc â€“init </code>. This will create a tsconfig file for us. One example is below:
								</div>
							</div>							
						</div><br>
						<div class="media">
							<div class="d-flex">
								<img src="img/technical/tsconfig.png" alt="">
							</div>						
						</div><br>
						<div class="media">							
							<div class="media-body">
								<div class="personal_text">															
									Be aware the included and excluded folders. OutDir can be set to either a different or the same folder as src. Now, we are ready to compile! <code>npx tsc</code>. After compiling we will see the generated files in the OutDir. You may have some errors like unresolved cy commands. Since you are running outside the cypress folder, it is not in the relevant namescape. But no worries, the dependency will be imported into some other projects and already be executed with Cypress.
								</div>
							</div>							
						</div><br>
						<div class="media">
							<div class="d-flex">
								<img src="img/technical/generatedFiles.png" alt="">
							</div>						
						</div><br>
						<div class="media">							
							<div class="media-body">
								<div class="personal_text">															
									<h2>Publish the Package</h2>													
									As we generate the compiled files, we will publish our package. First let's address our entry file in the package.json file. <code>"main": "src/index.js"</code>. Beware that it is not .ts anymore, since we compiled it is js file now. Now we can do <code>npm publish</code>. If you set the package name which is already taken, you will get an error. (it might be fixed later, but at first it was confusing to me, i got 403 when i tried to publish a conflicting package name.)									
								</div>
							</div>							
						</div><br>
						<div class="media">
							<div class="d-flex">
								<img src="img/technical/npmrepo.png" alt="">
							</div>						
						</div><br>
						<div class="media">							
							<div class="media-body">
								<div class="personal_text">															
									<h2>Using the Package in Other Projects</h2>													
									After the package is available in npm repo, it can be downloaded into any projects by <code>npm i mesutplugin</code>. i is for install, so this command will install the dependency. We will see that package & package.lock files are updated and node_modules folder includes the downloaded dependency. In the package.lock file, we can see the npm repo addresses (registry/nexus) which we discussed in the first part. You may realize in some dependencies, there is an '@' sign (scoped packages: see an example below), which indicates that this dependency belongs to a group. Other than the dependencies, consumed by the project, there are others:
									
									<ul>
										<li>Dev Dependencies</li>
										They are installed on npm install on a directory that contains package.json, unless you pass the --production flag or if the NODE_ENV=production environment variable is set. But they are not installed on npm install "$package" on any other directory, unless you give it the --dev option.
										<li>Peer Dependencies</li>	
										They are used when you create your own package. They are not require in the project, but the project can only be used with this peer dependency. This means, the Host having the project that we are developing, should also have the peer dependency. We can consider this as a compatibility. If there is a version (you might have a look into semantic versioning) issue, you will be notified. (it still runs though)
									</ul>
								</div>
							</div>							
						</div><br>	
						<div class="media">
							<div class="d-flex">
								<img src="img/technical/scopedpackage.png" alt="">
							</div>						
						</div><br>	
						<div class="media">							
							<div class="media-body">
								<div class="personal_text">															
									<h2>Using the Package in Other Projects</h2>													
									After the package is available in npm repo, it can be downloaded into any projects by <code>npm i mesutplugin</code>. i is for install, so this command will install the dependency. We will see that package & package.lock files are updated and node_modules folder includes the downloaded dependency. In the package.lock file, we can see the npm repo addresses (registry/nexus) which we discussed in the first part. You may realize in some dependencies, there is an '@' sign (scoped packages: see an example below), which indicates that this dependency belongs to a group. Other than the dependencies, consumed by the project, there are others:
									
									<ul>
										<li>Dev Dependencies</li>
										They are installed on npm install on a directory that contains package.json, unless you pass the --production flag or if the NODE_ENV=production environment variable is set. But they are not installed on npm install "$package" on any other directory, unless you give it the --dev option.
										<li>Peer Dependencies</li>	
										They are used when you create your own package. They are not require in the project, but the project can only be used with this peer dependency. This means, the Host having the project that we are developing, should also have the peer dependency. We can consider this as a compatibility. If there is a version (you might have a look into semantic versioning) issue, you will be notified. (it still runs though)
									</ul>
									
									After the dependency is installed, we are ready to use the served functions. But first we can register those function calls as the custom commands: <br><code>import {registerCommand} from 'mesutplugin'<br>registerCommand()</code><br><br>
									
									Now, instead of implementing all the steps from scratch, we can just call the relevant functions:
									
									
								</div>
							</div>							
						</div><br>
						<div class="media">
							<div class="d-flex">
								<img src="img/technical/test_with_custom_commands.png" alt="">
							</div>						
						</div><br>							
					</div>
				</div>
            </div>
        </section>
        <!--================End Home Banner Area =================-->
        
       
       
        
        
        
        
        
        
        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="js/jquery-3.3.1.min.js"></script>
        <script src="js/popper.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/stellar.js"></script>
        <script src="vendors/lightbox/simpleLightbox.min.js"></script>
        <script src="vendors/nice-select/js/jquery.nice-select.min.js"></script>
        <script src="vendors/isotope/imagesloaded.pkgd.min.js"></script>
        <script src="vendors/isotope/isotope.pkgd.min.js"></script>
        <script src="vendors/owl-carousel/owl.carousel.min.js"></script>
        <script src="vendors/popup/jquery.magnific-popup.min.js"></script>
        <script src="js/jquery.ajaxchimp.min.js"></script>
        <script src="vendors/counter-up/jquery.waypoints.min.js"></script>
        <script src="vendors/counter-up/jquery.counterup.min.js"></script>
        <script src="js/mail-script.js"></script>
        <script src="js/theme.js"></script>
    </body>
</html>