<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>API Call Example</title>
        <script>
            document.addEventListener("DOMContentLoaded", function(event) {
                getStats();
                getQuestion();
            });
        </script>
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                document.getElementById("checkButton").addEventListener("click", getAnswer);
                document.getElementById("next").addEventListener("click", getQuestion);
                document.getElementById("answer").addEventListener("keypress", function(e) {
                    if (e.key === "Enter") {
                        e.preventDefault(); // Prevent the default action for the Enter key in a form
                        getAnswer();
                    }
                });
            });
        </script>

    </head>

    <body>
        <label for="answer" style="font-weight: bold; font-size: 24px;">WELCOME to JAPANESE PRACTICE!</label><br>
        <div id="stats">Stats</div>
        <div id="question">Question</div>
        <input type="text" id="answer"><br>
        <div id="status"></div>
        <label id="result"></label>
        <button id="checkButton">Check</button>
        <button id="next">Next Question</button>
        <script>
            const hostIp = "http://192.168.1.124:8080/";

            function getAnswer() {
                const userInput = document.getElementById("answer").value;
                fetch(hostIp + 'getAnswer' + "?input=" + userInput) // Use your actual endpoint here
                    .then(response => response.json())
                    .then((data) => {
                        // Assuming 'data' is the map/object returned from the server
                        const container = document.getElementById('result');
                        container.innerHTML = ''; // Clear previous contents
                        // Assuming 'container' is the div where you want to add the labels
                        const label = document.getElementById('status');
                        const value = data["status"];
                        label.textContent = `Status: ${value}`;
                        label.style.fontSize = '24px';
                        console.log(value)
                        if (value)
                            label.style.color = 'green';
                        else
                            label.style.color = 'red';
                        container.appendChild(document.createElement('br'));

                        const correctWordsLabel = document.createElement('label');
                        const correctWordsValue = data["correctWords"];
                        correctWordsLabel.textContent = `correctWords: ${correctWordsValue}`;
                        container.appendChild(correctWordsLabel);

                        const row = document.createElement('div'); // Create a new div as a row
                        const order = ["trueInRow", "currentCorrect", "currentAnswered", "currentSuccess","note"];
                        // Iterate over each entry in the object
                        for (const key of order) {
                            const value = data[key];
                            if (value){
                                // Create a new label element
                                const label = document.createElement('label');
                                // Set the text of the label
                                label.textContent = `${key}: ${value}`;
                                // Append the label to the row

                                row.appendChild(label);

                                // Optional: Add a separator (e.g., comma, space) between labels
                                row.appendChild(document.createTextNode(', ')); // Adds a comma and a space
                            }

                        }

                        // Finally, append the row to the container
                        container.appendChild(row);

                    })
                    .catch((error) => {
                        console.error('Error:', error);
                        document.getElementById("result").textContent = "ERROR";
                    });
            }

            function getQuestion(){
                const label = document.getElementById('status');
                label.style.color = 'black';
                label.textContent = `Status:`;
                fetch(hostIp + 'getQuestion') // Use your actual endpoint here
                    .then(response => response.json())
                    .then((data) => {
                        // Assuming 'data' is the map/object returned from the server
                        const container = document.getElementById('question');
                        container.innerHTML = ''; // Clear previous contents
                        const answer = document.getElementById('answer');
                        answer.value = ''; // Clear previous contents

                        const order2 = ["trueInRow", "currentCorrect", "currentAnswered", "currentSuccess"];
                        const row2 = document.createElement('div'); // Create a new div as a row
                        // Assuming `data` is your object
                        for (const key of order2) {
                            const value = data[key];
                            // Create a new label element
                            const label = document.createElement('label');
                            // Set the text of the label
                            label.textContent = `${key}: ${value}`;
                            // Append the label to the row
                            row2.appendChild(label);

                            // Optional: Add a separator (e.g., comma, space) between labels
                            row2.appendChild(document.createTextNode(', ')); // Adds a comma and a space

                        }
                        container.appendChild(row2);
                        container.appendChild(document.createElement('br'));
                        const row = document.createElement('div'); // Create a new div as a row
                        const order = ["pickMode", "category"];
                        // Assuming `data` is your object
                        for (const key of order) {
                            const value = data[key];
                            // Create a new label element
                            const label = document.createElement('label');
                            // Set the text of the label
                            label.textContent = `${key}: ${value}`;
                            // Append the label to the row
                            row.appendChild(label);

                            // Optional: Add a separator (e.g., comma, space) between labels
                            row.appendChild(document.createTextNode(', ')); // Adds a comma and a space

                        }


                        let correctAnswers = data["correctlyAnswered"];
                        let totalAnswered = data["totalAnswered"];
                        const label = document.createElement('label');
                        label.textContent = `accuracy: ${correctAnswers}/${totalAnswered}`;
                        // Append the label to the row
                        row.appendChild(label);
                        container.appendChild(row);

                        const questionLabel = document.createElement('label');
                        let question = data["question"];
                        questionLabel.textContent = `question: ${question}`;
                        questionLabel.style.fontSize = '24px';
                        // Finally, append the row to the container
                        container.appendChild(questionLabel);

                    })
                    .catch((error) => {
                        console.error('Error:', error);
                        document.getElementById("result").textContent = "ERROR";
                    });
            }

            function getStats(){
                fetch(hostIp + 'getStats') // Use your actual endpoint here
                    .then(response => response.json()) // Parse the JSON from the response
                    .then(data => {
                        // Assuming 'data' is the map/object returned from the server
                        const container = document.getElementById('stats');
                        container.innerHTML = ''; // Clear previous contents

                        // Assuming 'container' is the div where you want to add the labels
                        const row = document.createElement('div'); // Create a new div as a row
                        const order = ["vocabularySize", "globalSuccessRate", "trueInARowRecord"];
                        // Iterate over each entry in the object
                        for (const key of order) {
                            const value = data[key];
                            // Create a new label element
                            const label = document.createElement('label');
                            // Set the text of the label
                            label.textContent = `${key}: ${value}`;
                            // Append the label to the row
                            row.appendChild(label);

                            // Optional: Add a separator (e.g., comma, space) between labels
                            row.appendChild(document.createTextNode(', ')); // Adds a comma and a space

                        }

                        // Finally, append the row to the container
                        container.appendChild(row);

                    })
                    .catch(error => console.error('Error fetching stats:', error));

            }
        </script>



    </body>
</html>
